webpackJsonp([1],{kJFK:function(e,t,r){var a=r("ylIj");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("6imX")("38f0b348",a,!0)},kODO:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Edqs"),i=r.n(a),l=r("L9TO"),n=r("xE3b"),o=r("tyP1"),s={data:function(){return{action:"/api/image/uploadfile",ruleForm:{id:"",title:"",images:[],detail:"",url:"",width:"",height:"",sort:"",validTime:""},rules:{images:[{type:"array",required:!0,trigger:"change",message:"请上传图片"}],title:[{required:!0,trigger:"blur",message:"请输入资讯标题"}],detail:[{required:!0,trigger:"blur",message:"请添加资讯详情"}],url:[{required:!0,trigger:"blur",message:"请配置链接URL地址"}],width:[{required:!0,trigger:"blur",message:"请输入广告位宽度"}],height:[{required:!0,trigger:"blur",message:"请输入广告位高度"}],sort:[{required:!0,trigger:"change",message:"请选择广告位置"}],validTime:[{required:!0,trigger:"change",message:"请选择有效期"}]},editorSetting:{width:600,height:400}}},created:function(){var e=this.$route.params&&this.$route.params.id;e&&(this.ruleForm={id:e.id,title:e.title,images:e.images,detail:e.detail,url:e.url,width:e.width,height:e.height,sort:e.sort,validTime:e.validTime})},methods:{handleDelImg:function(e,t){this.ruleForm.images.splice(t)},handleAvatarSuccess:function(e,t){console.log("图片上传返回：",e,t),this.ruleForm.images.push({goodPath:e.data,localPath:URL.createObjectURL(t.raw)})},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传图片大小不能超过 2MB!"),t},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var r=i()({},t.ruleForm);t.$route.params&&t.$route.params.id?Object(l.e)(r).then(function(e){200==e.code&&(t.$message({message:"修改成功",type:"success"}),setTimeout(function(){t.$router.push({name:"adslist"})},1e3))}):Object(l.a)(r).then(function(e){200==e.code&&(t.$message({message:"添加成功",type:"success"}),setTimeout(function(){t.$router.push({name:"adslist"})},1e3))})})},cancel:function(){this.$router.back(-1)}},components:{TitleLine:n.a,editor:o.a}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("title-line",{attrs:{txt:e.ruleForm.id?"编辑广告":"新建广告"}}),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"form",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"130px"}},[r("el-form-item",{staticStyle:{width:"312px"},attrs:{label:"广告标题",prop:"title"}},[r("el-input",{attrs:{disabled:!!e.ruleForm.id},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"广告图片",prop:"images"}},[e._l(e.ruleForm.images,function(t,a){return r("span",{key:a,staticClass:"news-img"},[r("i",{staticClass:"del-btn el-icon-remove",on:{click:function(r){e.handleDelImg(t,a)}}}),e._v(" "),r("img",{attrs:{src:t.localPath,alt:"图片"}})])}),e._v(" "),r("el-upload",{staticClass:"avatar-uploader",attrs:{multiple:!0,"with-credentials":!0,"show-file-list":!1,action:e.action,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],2),e._v(" "),r("el-form-item",{staticStyle:{width:"312px"},attrs:{label:"链接URL地址",prop:"url"}},[r("el-input",{model:{value:e.ruleForm.url,callback:function(t){e.$set(e.ruleForm,"url",t)},expression:"ruleForm.url"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"312px"},attrs:{label:"广告位宽度",prop:"width"}},[r("el-input",{attrs:{type:"number"},model:{value:e.ruleForm.width,callback:function(t){e.$set(e.ruleForm,"width",e._n(t))},expression:"ruleForm.width"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"312px"},attrs:{label:"广告位高度",prop:"height"}},[r("el-input",{attrs:{type:"number"},model:{value:e.ruleForm.height,callback:function(t){e.$set(e.ruleForm,"height",e._n(t))},expression:"ruleForm.height"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"312px"},attrs:{label:"选择广告位置",prop:"sort"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.ruleForm.sort,callback:function(t){e.$set(e.ruleForm,"sort",t)},expression:"ruleForm.sort"}},[r("el-option",{attrs:{label:"首页第一广告位",value:1}}),e._v(" "),r("el-option",{attrs:{label:"首页第二广告位",value:2}}),e._v(" "),r("el-option",{attrs:{label:"首页第三广告位",value:3}}),e._v(" "),r("el-option",{attrs:{label:"资讯页随机广告",value:99}})],1)],1),e._v(" "),r("el-form-item",{staticStyle:{width:"312px"},attrs:{label:"广告有效期",prop:"validTime"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},model:{value:e.ruleForm.validTime,callback:function(t){e.$set(e.ruleForm,"validTime",t)},expression:"ruleForm.validTime"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"312px"},attrs:{label:"广告详情",prop:"details"}},[r("editor",{staticClass:"editor",attrs:{value:e.ruleForm.detail,setting:e.editorSetting},on:{input:function(t){return e.ruleForm.detail=t}}})],1),e._v(" "),r("el-form-item",[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-add-cancel"],expression:"['ads-add-cancel']"}],attrs:{type:"info"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-add-publish"],expression:"['ads-add-publish']"}],attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("发布")])],1)],1)],1)},staticRenderFns:[]};var d=r("D8HT")(s,u,!1,function(e){r("kJFK")},"data-v-43eebfc0",null);t.default=d.exports},ylIj:function(e,t,r){(e.exports=r("bKW+")(!1)).push([e.i,"\n.app-container[data-v-43eebfc0] {\n  padding-left: 50px;\n}\n.app-container .title[data-v-43eebfc0] {\n    font-size: 30px;\n    color: #606266;\n}\n.app-container .form[data-v-43eebfc0] {\n    margin-top: 30px;\n    padding: 30px;\n    padding-bottom: 5px;\n    background: #f2f6fc;\n}\n.app-container .form .btn[data-v-43eebfc0] {\n      margin-top: 30px;\n}\n.avatar-uploader .el-upload[data-v-43eebfc0] {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload[data-v-43eebfc0]:hover {\n  border-color: #409eff;\n}\n.avatar-uploader-icon[data-v-43eebfc0] {\n  font-size: 28px;\n  color: #8c939d;\n  width: 120px;\n  height: 120px;\n  line-height: 120px;\n  text-align: center;\n  background: #fff;\n}\n.avatar[data-v-43eebfc0] {\n  width: 120px;\n  height: 120px;\n  display: block;\n}\n.news-img[data-v-43eebfc0] {\n  width: 120px;\n  height: 120px;\n  float: left;\n  margin: 0 10px 10px 0;\n  position: relative;\n}\n.news-img .del-btn[data-v-43eebfc0] {\n    position: absolute;\n    top: -8px;\n    right: -8px;\n    font-size: 20px;\n}\n.news-img img[data-v-43eebfc0] {\n    width: 100%;\n    height: 100%;\n    display: block;\n}\n",""])}});