webpackJsonp([16],{"N/gB":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("woOf"),s=a.n(l),i=a("L9TO"),n=a("6DDL"),r={data:function(){return{statusEnum:n.a,listLoading:!1,current_page:1,max_page:0,page_size:20,total_count:null,daterange:[],clickId:"",validdaterange:[],form:{publisher:"",title:"",status:"",sort:""},list:[{adNo:"222",title:"广告1",publisher:"唐先森",createTime:"20180715",sort:3,validTime:"20180706",status:3,id:100,images:[{goodPath:"http://p1.xiaoshidi.net/2018/08/17055418451694.jpg"}]}],selectedLists:[],dialogFormVisible:!1,dialogForm:{agree:0,remark:""}}},computed:{listQuery:function(){return s()({},this.form,{startApproveDate:this.daterange&&this.daterange[0]||null,endApproveDate:this.daterange&&this.daterange[1]||null,startValidDate:this.validdaterange&&this.validdaterange[0]||null,endValidDate:this.validdaterange&&this.validdaterange[1]||null,pageIndex:this.current_page,pageSize:this.page_size})}},filters:{statusFilter:function(e){return n.a.status[e]&&n.a.status[e].msg||""},sortFilter:function(e){return n.a.sort[e]&&n.a.sort[e].msg||""}},created:function(){this.fetchData()},methods:{audit:function(e){this.clickId=e,this.dialogFormVisible=!0},handleAgreeConfirm:function(e){var t=this;console.log(this.dialogForm),this.dialogFormVisible=!1,Object(i.c)({adIds:[this.clickId],status:this.dialogForm.agree,remark:this.dialogForm.remark}).then(function(e){200==e.code?(t.$message({message:"审核成功",type:"success"}),t.fetchData()):t.$message({message:e.msg,type:"error"})})},fetchData:function(){var e=this;this.listLoading=!0,console.log(this.listQuery),Object(i.h)(this.listQuery).then(function(t){e.listLoading=!1,200==t.code&&(e.list=t.data.data,e.total_count=t.data.total_count,e.current_page=t.data.current_page,e.max_page=t.data.max_page)}).catch(function(e){console.error("",e)})},currentPageChange:function(e){this.current_page=e,this.fetchData()},onSubmit:function(){this.fetchData()},add:function(){this.$router.push({name:"ads-add"})},goDetail:function(e){this.$router.push({name:"ads-detail",params:{id:e}})},goEdit:function(e){var t=this;this.listLoading=!0,Object(i.g)(e).then(function(e){t.listLoading=!1,e.data&&t.$router.push({name:"ads-edit",params:{id:e.data}})})},goUndercarriage:function(e){var t=this;this.$confirm("是否下架本条广告?","广告下架",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){Object(i.c)({adIds:[e],status:2,remark:""}).then(function(e){200==e.code?(t.$message({message:"下架成功",type:"success"}),t.fetchData()):t.$message({message:e.msg,type:"error"})})}).catch(function(){})},toggleSelection:function(e){var t=this;e&&e.forEach(function(e){t.$refs.adsTable.toggleRowSelection(e)})},handleSelectionChange:function(e){e&&e.length<=3?this.selectedLists=e:(this.toggleSelection([e[3]]),this.$message({message:"最多只能选择3条广告来置顶",type:"warning"}))}},components:{TitleLine:a("xE3b").a}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("title-line",{attrs:{txt:"广告列表"}}),e._v(" "),a("div",{staticStyle:{padding:"20px",background:"#F2F6FC"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"广告标题"}},[a("el-input",{attrs:{placeholder:"请输入广告标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发布人"}},[a("el-input",{attrs:{placeholder:"请输入发布人姓名"},model:{value:e.form.publisher,callback:function(t){e.$set(e.form,"publisher",t)},expression:"form.publisher"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发布日期"}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.daterange,callback:function(t){e.daterange=t},expression:"daterange"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"广告状态"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"失效",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"待审核",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"审核拒绝",value:"4"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"广告位"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}},[a("el-option",{attrs:{label:"首页第一广告位",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"首页第二广告位",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"首页第三广告位",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"资讯页随机广告",value:"99"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"有效期"}},[a("el-date-picker",{attrs:{type:"validdaterange","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.validdaterange,callback:function(t){e.validdaterange=t},expression:"validdaterange"}})],1),e._v(" "),a("el-row",{staticStyle:{height:"40px"}},[a("el-form-item",[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-list-search"],expression:"['ads-list-search']"}],attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")]),e._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-list-add"],expression:"['ads-list-add']"}],staticClass:"add-item",attrs:{type:"danger",icon:"el-icon-add"},nativeOn:{click:function(t){e.add(t)}}},[e._v("新增广告")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"total"},[e._v("广告总数：共"),a("span",[e._v(e._s(e.list.length))]),e._v("条")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"adsTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),e._v(" "),a("el-table-column",{staticClass:"table-item",attrs:{align:"center",label:"广告编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.adNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"广告标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.title))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"发布人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"link-type"},[e._v(e._s(t.row.publisher))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"发布时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.createTime?t.row.createTime:""))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"审核人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"link-type"},[e._v(e._s(t.row.approver))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"审核时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.approveTime?t.row.approveTime:""))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"广告位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:e.statusEnum.sort[t.row.sort].color},[e._v(e._s(e._f("sortFilter")(t.row.sort)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"有效期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.validTime?t.row.validTime:""))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"广告状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:e.statusEnum.status[t.row.status].color},[e._v(e._s(e._f("statusFilter")(t.row.status)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","class-name":"small-padding fixed-width",label:"操作",width:"340"},scopedSlots:e._u([{key:"default",fn:function(t){return[4!=t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-list-detail"],expression:"['ads-list-detail']"}],attrs:{size:"mini",type:"success",plain:""},on:{click:function(a){e.goDetail(t.row.id)}}},[e._v("\n            查看详情\n          ")]):e._e(),e._v(" "),1==t.row.status||3==t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-list-edit"],expression:"['ads-list-edit']"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){e.goEdit(t.row.id)}}},[e._v("\n            编辑\n          ")]):e._e(),e._v(" "),1==t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-list-offline"],expression:"['ads-list-offline']"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){e.goUndercarriage(t.row.id)}}},[e._v("\n            下架\n          ")]):e._e(),e._v(" "),3==t.row.status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ads-list-audit"],expression:"['ads-list-audit']"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){e.audit(t.row.id)}}},[e._v("\n            审核\n          ")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:!0,"current-page":e.current_page,"page-size":e.page_size,layout:"total, prev, pager, next, jumper",total:e.total_count},on:{"current-change":e.currentPageChange}})],1),e._v(" "),a("el-dialog",{attrs:{width:"30%",title:"广告审核",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.dialogForm}},[a("el-form-item",{attrs:{label:"审核意见","label-width":"120px"}},[a("el-radio",{attrs:{label:1},model:{value:e.dialogForm.agree,callback:function(t){e.$set(e.dialogForm,"agree",t)},expression:"dialogForm.agree"}},[e._v("同意")]),e._v(" "),a("el-radio",{attrs:{label:4},model:{value:e.dialogForm.agree,callback:function(t){e.$set(e.dialogForm,"agree",t)},expression:"dialogForm.agree"}},[e._v("不同意")])],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"120px"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.dialogForm.remark,callback:function(t){e.$set(e.dialogForm,"remark",t)},expression:"dialogForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAgreeConfirm}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(r,o,!1,function(e){a("oDsY")},"data-v-79c83b5b",null);t.default=c.exports},Twt6:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.app-container[data-v-79c83b5b] {\n  padding-left: 50px;\n}\n.app-container .title[data-v-79c83b5b] {\n    font-size: 30px;\n    color: #606266;\n}\n.app-container .btn-container[data-v-79c83b5b] {\n    padding-top: 30px;\n    text-align: center;\n}\n.app-container span.danger[data-v-79c83b5b] {\n    color: red;\n}\n.app-container .total[data-v-79c83b5b] {\n    margin: 5px 0;\n}\n.app-container .total span[data-v-79c83b5b] {\n      color: red;\n}\n",""])},oDsY:function(e,t,a){var l=a("Twt6");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a("rjj0")("6547446c",l,!0)}});