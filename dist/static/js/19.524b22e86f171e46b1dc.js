webpackJsonp([19],{Cbc4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("woOf"),a=n.n(r),o=n("vZz+"),s=n("xE3b"),i=n("R/pE"),l={data:function(){return a()({},i.a,{form:{name:""},rules:{name:[{required:!0,trigger:"blur"}]},roles:[]})},computed:{listQuery:function(){return a()({},this.form,{menus:this.getMenus(),id:this.$route.params.id})}},created:function(){this.dataInit()},methods:{dataInit:function(){var t=this;Object(o.b)({id:this.$route.params.id}).then(function(e){t.form.name=e.data.name,t.form.remark=e.data.remark,t.calcPermission(e.data.menus)})},calcPermission:function(t){var e=this;t.forEach(function(t){e.roles.push(t.feId),t.btnFeIds.split(",").forEach(function(t){e.roles.push(t)})}),this.selectSome(this.roles)},onSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$alert("请将表单填写完整","提示",{confirmButtonText:"确定"}),!1;e.update(e.listQuery)})},objectSpanMethod:function(t){var e=t.row;t.column,t.rowIndex;if(0===t.columnIndex)return e.span?{rowspan:e.span,colspan:1}:{rowspan:0,colspan:0}},update:function(t){var e=this;Object(o.e)(t).then(function(t){e.$alert("添加成功","提示",{confirmButtonText:"确定",callback:function(t){e.$router.push({name:"permission-list"})}})})},getMenus:function(){var t=this,e=[];return this.permissionList.forEach(function(n){n.status&&e.push({feId:n.id,btnFeIds:t.getBtns(n)})}),e},getBtns:function(t){var e=t.btns.filter(function(t){return t.status});return(e=e.map(function(t){return t.id})).join(",")},selectAll:function(t){this.permissionList.forEach(function(e){e.status=t,e.btns.forEach(function(e){e.status=t})})},selectSome:function(t){this.permissionList.forEach(function(e){e.status=t.indexOf(e.id)>-1,e.btns.forEach(function(e){e.status=t.indexOf(e.id)>-1})})}},components:{TitleLine:s.a}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("title-line",{attrs:{txt:"编辑角色"}}),t._v(" "),n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[n("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"角色描述",prop:"remark"}},[n("el-input",{attrs:{type:"textarea",rows:2,maxlength:"150"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"权限列表"}},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.selectAll(!0)}}},[t._v("全选")]),t._v(" "),n("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(e){t.selectSome(t.roles)}}},[t._v("重置")])],1),t._v(" "),n("el-table",{attrs:{stripe:!0,data:t.permissionList,"span-method":t.objectSpanMethod,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{prop:"spanName",label:"分类",width:"130"}}),t._v(" "),n("el-table-column",{attrs:{label:"页面",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-checkbox",{model:{value:e.row.status,callback:function(n){t.$set(e.row,"status",n)},expression:"scope.row.status"}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"amount1",label:"按钮"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.btns,function(r){return n("el-checkbox",{key:r.id,attrs:{disabled:!e.row.status},model:{value:r.status,callback:function(e){t.$set(r,"status",e)},expression:"item.status"}},[t._v(t._s(r.name))])})}}])})],1),t._v(" "),n("el-form-item",{staticClass:"btn",attrs:{size:"large"}},[n("el-button",{attrs:{type:"info"},nativeOn:{click:function(e){t.$router.back()}}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.onSubmit("ruleForm")}}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var c=n("VU/8")(l,u,!1,function(t){n("jJ2d")},"data-v-73611f93",null);e.default=c.exports},jJ2d:function(t,e,n){var r=n("rSAQ");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n("rjj0")("2a17280b",r,!0)},rSAQ:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n.app-container[data-v-73611f93] {\n  padding-left: 50px;\n}\n.app-container .title[data-v-73611f93] {\n    font-size: 30px;\n    color: #606266;\n}\n.app-container .form[data-v-73611f93] {\n    margin-top: 30px;\n}\n.app-container .form .btn[data-v-73611f93] {\n      margin-top: 30px;\n}\n",""])}});